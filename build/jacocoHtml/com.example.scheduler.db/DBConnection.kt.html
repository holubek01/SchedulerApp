<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="pl"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>DBConnection.kt</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Scheduler</a> &gt; <a href="index.source.html" class="el_package">com.example.scheduler.db</a> &gt; <span class="el_source">DBConnection.kt</span></div><h1>DBConnection.kt</h1><pre class="source lang-java linenums">package com.example.scheduler.db

import com.example.scheduler.utils.MessageUtil
import javafx.stage.Stage
import java.nio.file.Files
import java.nio.file.Path
import java.nio.file.Paths
import java.sql.Connection
import java.sql.DriverManager
import java.util.*

/**
 * Obiekt służący do zarządzania połączeniem z bazą danych.
 */
object DBConnection {
    private var connection: Connection? = null

    /**
     * Metoda pobierająca połączenie z bazą danych.
     *
     * @return     Obiekt Connection reprezentujący połączenie z bazą danych.
     */
    fun getConnection(): Connection {
<span class="pc bpc" id="L24" title="1 of 2 branches missed.">        if (connection == null) {</span>
<span class="fc" id="L25">            val prop = Properties()</span>
            //val configFile = Path.of(&quot;src/main/resources/config.properties&quot;)
<span class="fc" id="L27">            val configFile = Paths.get(&quot;&quot;).toAbsolutePath().resolve(&quot;config.properties&quot;)</span>

<span class="fc" id="L29">            try</span>
            {
<span class="pc bpc" id="L31" title="1 of 2 branches missed.">                if(Files.exists(configFile))</span>
                {
<span class="pc" id="L33">                    Files.newInputStream(configFile).use { input -&gt; prop.load(input)}</span>

<span class="fc" id="L35">                    val username = prop.getProperty(&quot;db.username&quot;)</span>
<span class="fc" id="L36">                    val password = prop.getProperty(&quot;db.password&quot;)</span>
<span class="fc" id="L37">                    val dbURL = prop.getProperty(&quot;db.name&quot;)</span>

<span class="fc" id="L39">                    connection = DriverManager.getConnection(dbURL, username, password)</span>
                }
                else
                {
<span class="nc" id="L43">                    println(&quot;file not found&quot;)</span>
                }
            }
<span class="nc" id="L46">            catch (e: Exception) {</span>
<span class="nc" id="L47">                println(&quot;Error while connecting to the database: ${e.message}&quot;)</span>
            }
        }
<span class="fc" id="L50">        return connection!!</span>
    }

    /**
     * Metoda zamykająca połączenie z bazą danych.
     */
    fun closeConnection() {
<span class="pc bpc" id="L57" title="1 of 2 branches missed.">        connection?.close()</span>
<span class="fc" id="L58">        connection = null</span>
<span class="fc" id="L59">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.9.202303310957</span></div></body></html>