<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="pl"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>CommonUtils.kt</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Scheduler</a> &gt; <a href="index.source.html" class="el_package">com.example.scheduler.utils</a> &gt; <span class="el_source">CommonUtils.kt</span></div><h1>CommonUtils.kt</h1><pre class="source lang-java linenums">package com.example.scheduler.utils

import io.github.palexdev.materialfx.controls.*
import javafx.collections.MapChangeListener
import javafx.geometry.Pos
import javafx.scene.control.Label
import javafx.scene.text.TextAlignment
import java.time.DayOfWeek
import java.time.LocalDate

/**
 * Klasa narzędziowa dostarczająca różne metody pomocnicze, wspólne dla wielu klas.
 */
object CommonUtils{

    /**
     * Mapa cyfr rzymskich oraz odpowiadających im wartości całkowitych.
     */
<span class="fc" id="L19">    private val romanNumeralsMap = mapOf(</span>
<span class="fc" id="L20">        1 to &quot;I&quot;,</span>
<span class="fc" id="L21">        2 to &quot;II&quot;,</span>
<span class="fc" id="L22">        3 to &quot;III&quot;,</span>
<span class="fc" id="L23">        4 to &quot;IV&quot;,</span>
<span class="fc" id="L24">        5 to &quot;V&quot;,</span>
<span class="fc" id="L25">        6 to &quot;VI&quot;,</span>
<span class="fc" id="L26">        7 to &quot;VII&quot;,</span>
<span class="fc" id="L27">        8 to &quot;VIII&quot;,</span>
<span class="fc" id="L28">        9 to &quot;IX&quot;,</span>
<span class="fc" id="L29">        10 to &quot;X&quot;</span>
    )

    /**
     * Odwrócona mapa cyfr rzymskich oraz odpowiadających im wartości całkowitych.
     */
<span class="fc" id="L35">    private val reverseRomanNumeralsMap = romanNumeralsMap.entries.associateBy({ it.value }, { it.key })</span>

    /**
     * Metoda, konwertująca liczbę całkowitą na cyfrę rzymską.
     *
     * @param num   Liczba całkowita do konwersji.
     * @return      Cyfra rzymska odpowiadająca zadanej liczbie całkowitej lub pusty ciąg znaków, jeśli liczba jest poza zakresem.
     */
    fun intToRoman(num: Int): String {
<span class="fc bfc" id="L44" title="All 2 branches covered.">        return romanNumeralsMap[num] ?: &quot;&quot;</span>
    }

    /**
     * Metoda, konwertująca cyfrę rzymską na liczbę całkowitą.
     *
     * @param roman     Cyfra rzymska.
     * @return          Liczba całkowita odpowiadająca cyfrze rzymskiej lub 0, jeśli konwersja nie jest możliwa (brak cyfry w mapie).
     */
    fun romanToInt(roman: String): Int {
<span class="fc bfc" id="L54" title="All 2 branches covered.">        return reverseRomanNumeralsMap[roman] ?: 0</span>
    }

    /**
     * Ustawia styl pól tekstowych.
     *
     * @param textFields    Pola tekstowe, dla których ma zostać ustawiony styl.
     */
    fun setTextFieldStyle(vararg textFields: MFXTextField) {
<span class="fc" id="L63">        textFields.forEach { textField -&gt;</span>
<span class="fc" id="L64">            textField.id = &quot;comboWhite&quot;</span>
<span class="fc" id="L65">        }</span>
<span class="fc" id="L66">    }</span>

    /**
     * Czyści pola typu MFXComboBox
     */
    fun clearBox(box: MFXComboBox&lt;*&gt;)
    {
<span class="fc" id="L73">        box.valueProperty().set(null)</span>
<span class="fc" id="L74">        box.clear()</span>
<span class="fc" id="L75">        box.selectionModel.clearSelection()</span>
<span class="fc" id="L76">    }</span>

    /**
     * Czyści pola typu MFXDatePicker
     */
    fun clearDatePicker(box: MFXDatePicker)
    {
<span class="fc" id="L83">        box.valueProperty().set(null)</span>
<span class="fc" id="L84">        box.clear()</span>
<span class="fc" id="L85">    }</span>


    /**
     * Metoda, zwracająca datę rozpoczęcia planu (data piątkowa potrzebna do stworzenia nazwy planu) na podstawie podanej daty.
     *
     * @param date      Wybrana data.
     * @return          Data rozpoczęcia planu.
     */
    fun getPlanStartDay(date: LocalDate): LocalDate {

<span class="pc bpc" id="L96" title="1 of 5 branches missed.">        val day = when (date.dayOfWeek) {</span>
<span class="fc" id="L97">            DayOfWeek.SATURDAY -&gt; date.minusDays(1)</span>
<span class="fc" id="L98">            DayOfWeek.SUNDAY -&gt; date.minusDays(2)</span>
<span class="fc" id="L99">            else -&gt; date</span>
        }

<span class="fc" id="L102">        return day</span>
    }


    /**
     * Metoda ustawiająca nasłuchiwanie (listener) na wybór elementu w tabeli.
     *
     * @param tableView Tabela.
     * @param menu Menu kontekstowe do wyświetlenia po kliknięciu na tabelę.
     * @param callback Callback wywoływany po wyborze elementu.
     * @param &lt;T&gt; Typ elementu w tabeli.
     */
    fun &lt;T&gt; setOnItemSelected(
        tableView: MFXTableView&lt;T&gt;,
        menu: MFXContextMenu,
        callback: (Int) -&gt; Unit
    ){
<span class="fc" id="L119">        tableView.selectionModel.selectionProperty()</span>
<span class="fc" id="L120">            .addListener(MapChangeListener&lt;Int?, T?&gt;</span>
            { change: MapChangeListener.Change&lt;out Int?, out T?&gt;? -&gt;
<span class="pc bpc" id="L122" title="1 of 2 branches missed.">                val selectedRowIndex = change!!.key ?: -1</span>

<span class="fc" id="L124">                tableView.selectionModel.clearSelection()</span>
<span class="fc" id="L125">                menu.hide()</span>

<span class="pc bpc" id="L127" title="1 of 2 branches missed.">                if (change.valueRemoved != change.valueAdded) {</span>
<span class="fc" id="L128">                    callback(selectedRowIndex)</span>
                }


<span class="fc" id="L132">            } as MapChangeListener&lt;in Int?, in T?&gt;?)</span>
<span class="fc" id="L133">    }</span>


    /**
     * Metoda wyświetlająca menu kontekstowe w odpowiednim miejscu na podstawie wybranego indeksu w tabeli.
     *
     * @param selectedRowIndex Wybrany indeks elementu w tabeli.
     * @param tableView Tabela.
     * @param menu Menu kontekstowe do wyświetlenia po kliknięciu na tabelę.
     * @param buttons Lista opcji (przycisków) do wyświetlenia w menu.
     * @param &lt;T&gt; Typ elementu w tabeli.
     */
    fun &lt;T&gt; showContextMenu(selectedRowIndex: Int, tableView: MFXTableView&lt;T&gt;, menu: MFXContextMenu, buttons: List&lt;MFXContextMenuItem&gt;){
<span class="fc" id="L146">        menu.items.clear()</span>
<span class="fc" id="L147">        menu.hide()</span>

<span class="fc" id="L149">        menu.items.addAll(buttons)</span>

<span class="pc bpc" id="L151" title="1 of 2 branches missed.">        val selectedRow = tableView.getCell(selectedRowIndex) as? MFXTableRow&lt;*&gt;</span>
<span class="pc bpc" id="L152" title="1 of 2 branches missed.">        if (selectedRow!=null)</span>
        {
<span class="nc" id="L154">            val bounds = selectedRow.boundsInParent</span>
<span class="nc" id="L155">            val boundsInWindow = tableView.localToScene(bounds.maxX, bounds.maxY)</span>
<span class="nc" id="L156">            val menuX = boundsInWindow.x + tableView.scene.window.x + 10</span>
<span class="nc" id="L157">            val menuY = boundsInWindow.y + tableView.scene.window.y + 40</span>

<span class="nc" id="L159">            menu.show(tableView, menuX, menuY)</span>
        }
<span class="fc" id="L161">    }</span>

    /**
     * Metoda tworząca etykietę wskazującą na powodzenie wykonania zadania.
     *
     * @param text Tekst etykiety.
     * @return Odpowiednio wystylizowana etykieta z tekstem.
     */
    fun createCompletedLabel(text: String): Label {
<span class="fc" id="L170">        val completedLabel = Label(text)</span>
<span class="fc" id="L171">        completedLabel.isWrapText = true</span>
<span class="fc" id="L172">        completedLabel.alignment = Pos.CENTER</span>
<span class="fc" id="L173">        completedLabel.textAlignment = TextAlignment.CENTER</span>
<span class="fc" id="L174">        completedLabel.styleClass.add(&quot;completed-label&quot;)</span>
<span class="fc" id="L175">        completedLabel.alignment = Pos.CENTER</span>
<span class="fc" id="L176">        return completedLabel</span>
    }

    /**
     * Metoda tworząca przycisk resetu
     * @return Odpowiednio wystylizowany przycisk resetu.
     */
    fun createResetButton(): MFXButton {
<span class="fc" id="L184">        val resetButton = MFXButton(MessageBundle.getMess(&quot;label.reset&quot;))</span>
<span class="fc" id="L185">        resetButton.id = &quot;customButton&quot;</span>
<span class="fc" id="L186">        resetButton.prefWidth = 150.0</span>
<span class="fc" id="L187">        return resetButton</span>
    }

    /**
     * Metoda tworząca przycisk aktualizacji
     * @return Odpowiednio wystylizowany przycisk aktualizacji.
     */
    fun createUpdateButton(): MFXButton
    {
<span class="fc" id="L196">        val updateButton = MFXButton(MessageBundle.getMess(&quot;label.update&quot;))</span>
<span class="fc" id="L197">        updateButton.id = &quot;customButton&quot;</span>
<span class="fc" id="L198">        updateButton.prefWidth = 200.0</span>
<span class="fc" id="L199">        return updateButton</span>
    }

    /**
     * Usuwa zależności dla pól pomiędzy krokami w stepper.
     *
     * @param stepper Komponent MFXStepper, z którego mają być usunięte zależności.
     * @param params  Lista pól tekstowych, dla których mają zostać usunięte zależności.
     */
    fun removeStepDependencies(stepper: MFXStepper, vararg params: MFXTextField)
    {
<span class="fc" id="L210">        params.forEach { stepper.stepperToggles[0].validator.removeDependency(it.validator) }</span>
<span class="fc" id="L211">        stepper.stepperToggles.removeAll(stepper.stepperToggles)</span>
<span class="fc" id="L212">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.9.202303310957</span></div></body></html>